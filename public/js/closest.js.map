{"version":3,"file":"closest.js","sources":["../../index.js","../../src/js/private/utils.js","../../src/js/private/components.js","../../src/js/closest.js"],"sourcesContent":["export default function Z(obj) {\n  Z[obj.id] = obj;\n}\n\nZ.xhr = function (obj, arr, i, cb, ls, xhr, id) {\n  arr = arr || [];\n  ls = obj.local && obj.local();\n  if(ls){\n    arr[i||0] = obj.callback ? obj.callback(ls) : ls;\n    cb && !~arr.indexOf(undefined) && cb(arr);\n  }else{\n    xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState == 4) {\n        arr[i || 0] = xhr.status == (obj.status || 200) ? obj.callback ? obj.callback(xhr.responseText) : xhr.responseText : NaN;\n        cb && !~arr.indexOf(undefined) && cb(arr);\n      }\n    };\n    xhr.open(obj.method || \"GET\", obj.url, true);\n    for (id in obj.headers) {\n      xhr.setRequestHeader(id, obj.headers[id]);\n    }\n    xhr.send(obj.body);\n  }\n};\n\nZ.xhrs = function (arr, callback, arrResolved, i) {\n  arrResolved = arr.map(function(){});\n  for (i in arr){\n    Z.xhr(arr[i], arrResolved, i, callback);\n  }\n};","const nasaRootUrl =\n  \"https://api.nasa.gov/neo/rest/v1/feed?api_key=yo8sBiXIkrfsPQYtovghFK3ysIUiVjJ16ncO7ts7&detailed=true&\";\nconst proxyRootUrl = \"//localhost:8900/api?\";\nconst closetQueryString = \"start_date=2015-12-19&end_date=2015-12-26\";\n\nexport const nasaEndpoint = nasaRootUrl + closetQueryString;\nexport const proxyNasaEndpoint = proxyRootUrl + closetQueryString;\n\nexport const queryLocalstoreById = (id) => {\n  const timestamp = localStorage.getItem(id + \"-timestamp\");\n  const oneMonthInMilliseconds = 1000 * 60 * 60 * 24 * 30;\n  if (!timestamp || Date.now() - timestamp > oneMonthInMilliseconds) {\n    localStorage.setItem(id + \"-timestamp\", Date.now());\n    return false;\n  }\n  return localStorage.getItem(id);\n};\n\nexport const endpointsForMonth = (month, year) => {\n  // get Days in given month and year\n  const days = new Date(year, month, 0).getDate();\n\n  let sevenDayRangeObjects = [];\n\n  for (let i = 0; i < days; i++) {\n    if (i % 7 === 0) {\n      sevenDayRangeObjects.push({\n        start: i + 1,\n        end: i + 7 < days ? i + 7 : days,\n      });\n    }\n  }\n\n  return sevenDayRangeObjects.map((obj) => {\n    return `${nasaRootUrl}start_date=${year}-${month}-${obj.start}&end_date=${year}-${month}-${obj.end}`;\n  });\n};\n\nexport const paginationCalculation = (current, start, end) => {\n  const halfWayToStart = start + Math.floor((current - start) / 2);\n  const halfWayToEnd = end - Math.floor((end - current) / 2);\n  return [\n    {\n      value: start,\n      target: start,\n      disabled: current === start ? true : false,\n    },\n    {\n      value: halfWayToStart <= start ? \"…\" : halfWayToStart,\n      target: halfWayToStart,\n      disabled: halfWayToStart <= start ? true : false,\n    },\n    {\n      value: \"previous\",\n      target: current === start ? current : current - 1,\n      disabled: current === start ? true : false,\n    },\n    {\n      value: \"next\",\n      target: current === end ? current : current + 1,\n      disabled: current === end ? true : false,\n    },\n    {\n      value: halfWayToEnd >= end ? \"…\" : halfWayToEnd,\n      target: halfWayToEnd,\n      disabled: halfWayToEnd >= end ? true : false,\n    },\n    {\n      value: end,\n      target: end,\n      disabled: current === end ? true : false,\n    },\n  ];\n};\n\nexport const jsonToList = (value, opts) => {\n  const type = typeof value;\n  if (type === \"string\" || type === \"number\" || type === \"boolean\") {\n    if (type === \"string\" && value.indexOf(\"http\") === 0) {\n      return `: <a href=\"${value}\">${value}</a>`;\n    }\n    return `: <b>${value}</b>`;\n  } else if (typeof value === \"object\") {\n    if (!Array.isArray(value)) {\n      return Object.keys(value)\n        .map((key) => {\n          return `\n            <ul>\n                <li>\n                    ${key.replace(/_/g, \" \")}${jsonToList(value[key])}\n                </li>\n            </ul>\n          `;\n        })\n        .join(\"\");\n    } else {\n      return value\n        .map((element) => {\n          return jsonToList(element);\n        })\n        .join(\"\");\n    }\n  }\n};\n\nexport const orderAsteroidsByDistanceFromEarth = (data) => {\n  let restructuredArrayOfAsteroids = [];\n  Object.keys(data.near_earth_objects).forEach((date) => {\n    data.near_earth_objects[date].forEach((asteroid) => {\n      restructuredArrayOfAsteroids.push(asteroid);\n    });\n  });\n  return restructuredArrayOfAsteroids.sort((a, b) => {\n    return (\n      a.close_approach_data[0].miss_distance.kilometers -\n      b.close_approach_data[0].miss_distance.kilometers\n    );\n  });\n};\n\nexport const orderOneMonthsAsteroidsByDiameter = (data) => {\n  let restructuredArrayOfAsteroids = [];\n  data.forEach((week) => {\n    Object.keys(week.near_earth_objects).forEach((date) => {\n      week.near_earth_objects[date].forEach((asteroid) => {\n        restructuredArrayOfAsteroids.push(asteroid);\n      });\n    });\n  });\n  return restructuredArrayOfAsteroids.sort((a, b) => {\n    return (\n      b.estimated_diameter.meters.estimated_diameter_max -\n      a.estimated_diameter.meters.estimated_diameter_max\n    );\n  });\n};\n","import { paginationCalculation } from \"./utils.js\";\n\nexport const head = (obj) => {\n  Z.mount({\n    id: \"head\",\n    render: () => {\n      document.getElementsByTagName(\"head\")[0].innerHTML = `\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <link rel=\"stylesheet\" type=\"text/css\" href=\"/css/style.css\" />\n      <title></title>\n      <link rel=\"apple-touch-icon\" sizes=\"180x180\" href=\"/apple-touch-icon.png\">\n      <link rel=\"icon\" type=\"image/png\" sizes=\"32x32\" href=\"/favicon-32x32.png\">\n      <link rel=\"icon\" type=\"image/png\" sizes=\"16x16\" href=\"/favicon-16x16.png\">\n      <link rel=\"manifest\" href=\"/site.webmanifest\">\n      <link rel=\"mask-icon\" href=\"/safari-pinned-tab.svg\" color=\"#007ef8\">\n      <meta name=\"msapplication-TileColor\" content=\"#f7f6f5\">\n      <meta name=\"theme-color\" content=\"#f7f6f5\">        \n    `;\n    },\n  });\n\n  Z.mount({\n    id: \"title\",\n    render: (state) => {\n      document.getElementsByTagName(\"title\")[0].innerHTML = state;\n    },\n    state: obj.title,\n  });\n};\n\nexport const body = (obj) =>\n  Z.mount({\n    id: \"body\",\n    render: (state) => {\n      document.getElementsByTagName(\"body\")[0].innerHTML = `\n      <header id=\"header\"></header>\n      <main id=\"main\" class=\"${state}\"></main>\n      <footer id=\"footer\"></footer>\n    `;\n    },\n    state: obj.class,\n  });\n\nexport const header = () =>\n  Z.mount({\n    id: \"header\",\n    render: () => {\n      document.getElementById(\"header\").innerHTML = `\n        <nav>\n          <a href=\"/\" >\n            <img src=\"/images/nasa-logo.png\" alt=\"nasa logo\" />\n          </a>\n          <input id=\"menu\" type=\"checkbox\" />\n          <label for=\"menu\"></label>\n          <ul>\n            <li>\n                <a href=\"/closest\" >closest</a>\n            </li>\n            <li>\n                <a href=\"/biggest\" >biggest</a>\n            </li>        \n          </ul>\n        </nav>\n      `;\n    },\n  });\n\nexport const footer = () =>\n  Z.mount({\n    id: \"footer\",\n    render: () => {\n      document.getElementById(\n        \"footer\"\n      ).innerHTML = `<p>In case you haven't already guessed; This is not the real NASA. It's not even the real NASA logo, I used <a href=\"https://dribbble.com/shots/10741319-NASA\">this excellent</a> concept. This is just a website created to complete an assignment. If you are interested in the code. You can check it out <a href=\"https://github.com/Paul-Browne/nasa-assignment\">here at github</a> Also I apologize if you had to wait 15 seconds to see the data for the closest and biggest asteroids. This is because the <a href=\"https://api.nasa.gov\">NASA API</a> takes ages. &copy; Paul Browne 2021</p>`;\n    },\n  });\n\nexport const pagination = (length, index) =>\n  Z.mount({\n    id: \"pagination\",\n    render: (state) => {\n      const arr = paginationCalculation(state.index + 1, 1, state.length);\n      document.getElementById(\"pagination\").innerHTML = `\n        <nav class=\"pagination\">\n          ${arr\n            .map((el) => {\n              return `          \n                  <button onclick=\"Z.pagination.moveToN(${el.target - 1})\" ${\n                el.disabled ? \"disabled\" : \"\"\n              } class=\"pagination-button\">${el.value}</button>\n              `;\n            })\n            .join(\"\")}\n        </nav>\n      `;\n    },\n    state: {\n      index: index,\n      length: length,\n      moveToN: function (index) {\n        if (index == this.index) return;\n        Z.main.index = index;\n        Z.pagination.index = index;\n        Z.title = Z.main.data[index].name;\n\n        Z.update(\"main\");\n        Z.update(\"pagination\");\n        Z.update(\"title\");\n      },\n    },\n  });\n","import Z from \"../../index.js\";\nimport { head, body, header, footer, pagination } from \"./private/components\";\nimport {\n  nasaEndpoint,\n  proxyNasaEndpoint,\n  jsonToList,\n  orderAsteroidsByDistanceFromEarth,\n  queryLocalstoreById,\n} from \"./private/utils.js\";\n\nhead({\n  title: \"NASA &middot; Closest Asteroids\",\n});\n\nbody({\n  class: \"closest\",\n});\n\nZ.mount({\n  id: \"container\",\n  render: () => {\n    document.getElementById(\"main\").innerHTML = `\n      <section id=\"asteroid-data\">\n        <code>Loading...</code>\n      </section>\n      <div id=\"pagination\"></div>\n    `;\n  },\n});\n\nheader();\n\nfooter();\n\nZ.load(\n  [\n    {\n      id: \"req_2015_12_3\",\n      url: nasaEndpoint,\n      local: () => {\n        return queryLocalstoreById(\"req_2015_12_3\");\n      },\n      callback: (data) => {\n        localStorage.setItem(\"req_2015_12_3\", data);\n        return orderAsteroidsByDistanceFromEarth(JSON.parse(data));\n      },\n    },\n  ],\n  (mainData) => {\n    Z.mount({\n      id: \"main\",\n      render: (state) => {\n        const asteroid = state.data[state.index];\n        document.getElementById(\"asteroid-data\").innerHTML = `\n          <h1>${state.index + 1}: ${asteroid.name}</h1>\n          <div>\n            ${jsonToList(asteroid)}\n          </div>\n        `;\n      },\n      state: {\n        index: 0,\n        data: mainData[0],\n      },\n    });\n    pagination(mainData[0].length, 0);\n    Z.title = mainData[0][0].name;\n    Z.update(\"title\");\n  }\n);\n"],"names":["Z","obj","id","xhr","arr","i","cb","ls","local","callback","indexOf","undefined","XMLHttpRequest","onreadystatechange","readyState","status","responseText","NaN","open","method","url","headers","setRequestHeader","send","body","xhrs","arrResolved","map","jsonToList","value","opts","type","Array","isArray","element","join","Object","keys","key","replace","pagination","length","index","mount","render","state","current","start","end","halfWayToStart","halfWayToEnd","Math","floor","target","disabled","document","getElementById","innerHTML","el","moveToN","this","main","title","data","name","update","getElementsByTagName","class","load","nasaRootUrl","timestamp","localStorage","getItem","Date","now","setItem","restructuredArrayOfAsteroids","near_earth_objects","forEach","date","asteroid","push","sort","a","b","close_approach_data","miss_distance","kilometers","orderAsteroidsByDistanceFromEarth","JSON","parse","mainData"],"mappings":"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"}